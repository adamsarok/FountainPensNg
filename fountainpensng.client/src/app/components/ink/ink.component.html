<div class="root-div">
  <div class="image-container">
    @if (ink.imageUrl) {
      <img alt="image of an ink swatch" [src]="ink.imageUrl" />
    } @else {
      <mat-icon style="width: 100%; height: 100%; opacity: 0.25" svgIcon="pen-nib"
        >menu</mat-icon
        >
      }
    </div>
    <app-image-uploader
      (selectedFile)="onFileSelected($event)"
    ></app-image-uploader>
    <form style="margin-top: 16px" [formGroup]="form" (ngSubmit)="onSubmit()">
      <div fxLayout="column" fxLayoutAlign="center center">
        <div fxFlex="100%">
          <mat-form-field appearance="outline" class="form-field">
            <mat-label>Maker</mat-label>
            <input matInput formControlName="maker" name="maker" />
            @if (form.get('maker')?.hasError('required')) {
              <mat-error
                >This field is required</mat-error
                >
              }
            </mat-form-field>
          </div>

          <div fxFlex="100%">
            <mat-form-field appearance="outline" class="form-field">
              <mat-label>Name</mat-label>
              <input matInput formControlName="inkName" name="inkName" />
              @if (form.get('inkName')?.hasError('required')) {
                <mat-error
                  >This field is required</mat-error
                  >
                }
              </mat-form-field>
            </div>

            <div fxFlex="100%">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Comment</mat-label>
                <input matInput formControlName="comment" name="comment" />
                @if (form.get('comment')?.hasError('required')) {
                  <mat-error
                    >This field is required</mat-error
                    >
                  }
                </mat-form-field>
              </div>

              <div fxFlex="100%">
                <mat-form-field appearance="outline" class="form-field">
                  <mat-label>Color</mat-label>
                  <input type="color" matInput formControlName="color" name="color" />
                  @if (form.get('color')?.hasError('required')) {
                    <mat-error
                      >This field is required</mat-error
                      >
                    }
                  </mat-form-field>
                </div>

                <div fxFlex="100%">
                  <mat-form-field appearance="outline" class="form-field">
                    <mat-label>Rating</mat-label>
                    <input matInput formControlName="rating" name="rating" />
                    @if (form.get('rating')?.hasError('required')) {
                      <mat-error
                        >This field is required</mat-error
                        >
                      }
                    </mat-form-field>
                  </div>

                  <div fxFlex="100%">
                    <mat-form-field appearance="outline" class="form-field">
                      <mat-label>Milliliters</mat-label>
                      <input matInput formControlName="ml" name="ml" />
                      @if (form.get('ml')?.hasError('ml')) {
                        <mat-error
                          >This field is required</mat-error
                          >
                        }
                      </mat-form-field>
                    </div>

                    <div fxFlex="100%">
                      @if (validationErrors) {
                        <div class="row">
                          <ul class="text-danger">
                            @for (error of validationErrors; track error) {
                              <li>
                                {{ error }}
                              </li>
                            }
                          </ul>
                        </div>
                      }
                      <div class="btn-container">
                        <button mat-flat-button color="primary" type="submit">
                          {{ ink.id ? "Update" : "Create" }}
                        </button>
                        @if (ink.id) {
                          <button
                            mat-flat-button
                            color="warn"
                            type="button"
                            (click)="deleteInk()"
                            >
                            Delete
                          </button>
                        }
                      </div>
                    </div>
                  </div>
                </form>
                <table mat-table [dataSource]="inkedUps">
                  <ng-container matColumnDef="inkedAt">
                    <th mat-header-cell *matHeaderCellDef>Inked At</th>
                    <td mat-cell *matCellDef="let element">{{ element.inkedAt }}</td>
                  </ng-container>
                  <ng-container matColumnDef="matchRating">
                    <th mat-header-cell *matHeaderCellDef>Match Rating</th>
                    <td mat-cell *matCellDef="let element">{{ element.matchRating }}</td>
                  </ng-container>
                  <ng-container matColumnDef="pen">
                    <th mat-header-cell *matHeaderCellDef>Pen</th>
                    <td mat-cell *matCellDef="let element">
                      {{ element.penMaker }} {{ element.penName }}
                      <input type="color" value="{{ element.penColor }}" disabled />
                    </td>
                  </ng-container>
                  <tr mat-header-row *matHeaderRowDef="inkedUpDisplayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: inkedUpDisplayedColumns"></tr>
                </table>
              </div>
